0 REM     OSI GRAND
1 REM  by:                     Alan Stankiewicz      & Bruce Robinson
2 REM                          COPYRIGHT 1982  
4 GOSUB1000:GOTO20
5 U4=PEEK(129):U5=PEEK(130):POKE129,0:POKE130,212:U$=" ":FORU=1TO7
6 U$=U$+U$+" ":NEXT:POKE129,U4:POKE130,U5:RETURN
20 GOSUB4500
25 FORQ=1TONB:W(Q)=-1:NEXT:W(0)=0
110 FORB=0TONB:IFNOT(W(B))THENGOSUB900:GOSUB800
120 NEXT:IFPFTHENGOSUB700
130 PS=P(P):IFP=P8THEN6480
140 IFBXTHEN6000
195 CT=CT+1:ONCTGOSUB200,200,210,200,200,240,200,200,270
199 GOTO110
200 POKEU6,BL:RETURN
210 POKEU1,V1:POKEU2,V1:POKEU3,V3:RETURN
240 POKEU1,V4:POKEU2,V5:POKEU3,V6:RETURN
270 POKEU1,V5:POKEU2,V6:POKEU3,V8:POKEU6,U7:CT=0:RETURN
700 FORJ=0TONB:IFW(J)=-1THENW(J)=0:J=9:PF=0
710 NEXT:RETURN
800 J=L(W(B)):IFW(B)=NTHENPOKEJ,BL:W(B)=-1:P=P+1:GOTO2000
810 IFPEEK(J+I)=DBTHEN5000
820 W(B)=W(B)+1:K=L(W(B)):IFW(B)=PSTHENPF=1
825 IFJ=KTHENRETURN
830 POKEK,BA:POKEJ,BL:RETURN
900 J=PEEK(KF)
910 N1=NP:IFJ=RITHEN950
915 IFLE<>JTHENRETURN
920 NX=NX-1:IFNX<3THENNX=3:RETURN
930 NP=NP-1:POKENP,NE:POKEN1+Z,DB:RETURN
950 NX=NX+1:IFNX>RLTHENNX=RL:RETURN
960 NP=NP+1:POKENP+Z,NE:POKEN1,DB:RETURN
1000 DATA3,4,3,4,3,4,4,5,4,5,4,5,4,6,4,6,4,7,4,7,5,8,5,8,5,9,5,9
1010 DATA5,10,5,10,5,11,5,12,6,13,6,14,6,15,6,16,6,17,6,18,6,19,6,20
1020 DATA6,21,6,22,6,21,7,20,8,19,9,19,10,19,11,20,12,21,12,22,12,21
1030 DATA13,20,14,19,15,19,16,19,17,20,18,21,18,22,18,21,19,20,20,19
1040 DATA21,20
1050 UL=53380
1051 Z=2
1052 I=32
1053 PH=1
1054 DP=64000
1055 BL=32:KF=57100:DB=96
1056 LE=250:RI=252
1057 NET=183
1058 N=48
1059 P8=10:P9=17
1060 BA=240
1061 TL=3
1062 AK=1
1063 PM=5
1065 NB=4
1066 IFSL=0THENDIMW(NB),L(N),P(P9),GR(7),IT(7)
1067 P=0:PT=0
1068 O$="00000"
1069 OL=5
1070 V1=181:V3=182:V4=242:V5=7:V6=180:V8=245:V9=230
1072 U1=UL+2*I:U2=UL+2*I+1:U3=U1+2
1075 U6=UL+I+1
1076 U7=241
1080 IFPEEK(57088)<128THENI=64:LE=5:RI=3
1082 POKE56832,1
1083 AZ=46
1090 SL=UL+20+I*3
1100 GOSUB5:GOSUB2050
1110 GOSUB1500
1113 FORJ=UL+24*ITOUL+24*I+24:POKEJ,135:NEXT
1140 FORQ=1TON:READX,Y:L(Q)=UL+X+Y*I:NEXT:L(0)=DP
1145 UT=UL+20+21*I
1150 FORJ=0TO2:FORK=0TO3:READM:POKEUT+K+J*I,M:NEXT:NEXT
1160 DATA143,32,32,136,143,128,128,161,96,226,32,226
1170 TR=UT+1+I
1185 FORQ=0TO3:READM:GR(Q)=M:GR(Q+4)=M:NEXT
1187 DATA161,159,154,144
1190 FORQ=0TO3:IT(Q)=1:NEXT
1200 DATA47,32,24,12,12,12,12,12
1202 DATA12,12,12
1205 DATA12,11,10,9,8,7,6
1210 FORQ=0TOP9:READM:P(Q)=M:NEXT
1220 IFST=0THENGOSUB9000
1299 RETURN
1500 FORJ=3TO23:FORK=0TO2:POKEUL+J*I+K,161:NEXT:NEXT
1510 FORJ=4TO20STEP4:POKEUL+J*I+1,32:NEXT
1520 RETURN
2000 S$=STR$((P*PH+PT)*10)
2001 S$=MID$(S$,2):J=LEN(S$):S$=RIGHT$(O$,OL-J)+S$
2002 SP=SL-LEN(S$):E=P8-P:IFE>7THEN2010
2004 E1=TR-IT(E)*I:POKEE1,GR(E):POKEE1+1,GR(E)
2010 FORY=1TOLEN(S$):POKESP+Y,ASC(MID$(S$,Y,1)):NEXT:RETURN
2050 GOTO2000
2053 SP=SL-6-I
2055 GOSUB2010
2060 GOTO2000
2100 POKETR,128:POKETR+1,128:POKETR-I,BL:POKETR-I+1,BL:RETURN
4500 RL=20-Z:NX=RL:NP=UL+23*I+NX
4510 FORJ=3TO20:POKEUL+23*I+J,DB:NEXT
4520 FORQ=0TOZ:POKENP+Q,NE:NEXT:RETURN
5000 BX=1
5010 J=L(W(B)):POKEJ,BL:W(B)=-1
5015 J1=J:J=J+I
5016 POKEJ,4
5017 FORQ=1TO50:NEXT
5020 POKEJ,4:FORQ=-1TO1:POKEJ1+Q,AZ:NEXT
5025 FORK=1TO133:NEXT
5030 FORQ=-1TO1:POKEJ1+Q,BL:NEXT
5040 POKEJ,DB
5050 FORQ=1TO100:NEXT
5055 IFZ=2THENRETURN
5057 POKEST+18,161
5060 POKE12,ST/256:POKE11,ST-256*INT(ST/256):X=USR(X)
5070 FORQ=525TO1STEP-1:NEXT
5075 IFZ=0THENGOSUB8000
5080 POKEST+18,32:X=USR(X):POKEST+18,187
5085 POKEST+18,161
5099 RETURN
5500 FORJ=0TONB:IFW(J)<>-1THENPOKEL(W(J)),BL
5510 NEXT:RETURN
6000 BX=0:GOSUB5500:PT=PT+P*PH:P=0:TL=TL-1:IFTLTHENGOSUB2100:GOTO25
6030 IFPT>BSTHENBS=PT:GOSUB6100:PRINT"NEW HIGH SCORE!";:GOTO6050
6040 GOSUB6100:PRINT"HI SCORE ="BS*10;
6050 POKE11,0:POKE12,253
6060 X=USR(X):IFPEEK(531)<>82THEN6060
6070 RESTORE:GOTO1
6100 PRINTCHR$(13)CHR$(161)CHR$(161);:RETURN
6480 P1=PH:PH=PH+1:IFZTHENZ=Z-1:GOTO6500
6490 IFP8<P9THENP8=P8+1
6500 IFZ=0ANDPH<5THENPH=5
6502 GOSUB2100
6505 PT=PT+P1*P:P=0
6510 GOSUB5500:GOTO20
8000 S8=ST+18
8005 FORY=1TO2
8010 POKES8,170
8020 GOSUB8900
8030 POKES8,169
8040 GOSUB8900
8080 NEXT:RETURN
8900 X=USR(X)
8910 FORQ=1TO200:NEXT
8920 RETURN
9000 SP$="111011101000010011101"
9010 SP$=SP$+"100010101000101001001"
9020 SP$=SP$+"111011101000111001001"
9030 SP$=SP$+"001010001000101001000"
9040 SP$=SP$+"111010001110101001001"
9050 ST=560
9051 DATA234:READM:IFM<>234THENSTOP
9055 FORQ=STTOST+48:READM:POKEQ,M:NEXT
9060 SM=ST+49
9070 FORQ=1TOLEN(SP$):POKESM+Q-1,VAL(MID$(SP$,Q,1)):NEXT
9080 J=INT(SM/256):K=SM-J*256:POKEST+13,K:POKEST+14,J
9090 DS=UL+3+10*I
9100 J=INT(DS/256):POKE225,J:POKE224,DS-256*J
9110 POKEST+18,187
9120 POKEST+39,2
9130 POKEST+43,100
9300 RETURN
9508 DATA165,224,133,226,165,225,133,227,162,0,160,0,189,0,0
9510 DATA240,4,169,161,208,2,169,32,145,226,200,232,192,21,48
9512 DATA237,24,165,226,105,32,133,226,144,0,230,227,224,110,48
9514 DATA220,96,234,234
9999 REM 1280 HIGHEST     SCORE!!!
POKE515,0:RUN
