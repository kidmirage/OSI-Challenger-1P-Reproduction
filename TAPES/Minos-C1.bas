10 DATA162,0,169,32,157,0,208,157,0,209,157,0,210,157,0,211,157,0,212
20 DATA157,0,213,157,0,214,157,0,215,232,208,229,96
30 GOSUB1310:Q=SR
50 POKE12,Q/256:M=PEEK(12):POKE11,Q-256*M
60 READM:POKEQ,M:IFM<>96THENQ=Q+1:GOTO60
65 X=USR(X)
70 PRINT"      MINOS
72 PRINT
74 PRINT"[space bar] MOVES AHEAD
76 PRINT"[>] TURN RIGHT
78 PRINT"[<] TURN LEFT
80 PRINT"[B] TURN AROUND
82 PRINT"[R] RECALL MOVES
84 PRINT
86 INPUT"DIFFICULTY (0-9)";DI:IFDI<0ORDI>9THEN86
88 POKESR-1,DI
90 PRINT
92 PRINT"SIZE OF MAZE (H,W)
94 PRINTVM"by"HM"MAXIMUM";:INPUTV,H
96 IFV>VMORV<4ORH>HMORH<4THEN92
98 PRINT
99 POKESR-2,H:POKESR-3,V
100 H=INT(H/2):V=INT(V/2)
110 BO=161:WA=96:CO=32
112 DIMW(H,V),V(H,V)
155 Q=0:Z=0
160 X=INT(RND(8)*H+1)
162 FORI=-2TOH*2:PRINTCHR$(BO);:NEXT:PRINT
165 PRINTCHR$(BO);:FORI=1TOH:PRINTCHR$(WA);
167 IFI=XTHENPRINTCHR$(CO);:GOTO172
170 PRINTCHR$(WA);
172 NEXT:PRINTCHR$(WA);CHR$(BO)
195 W(X,1)=1:C=2
200 R=X:S=1:GOTO260
210 IFR<>HTHEN240
215 IFS<>VTHEN230
220 R=1:S=1:GOTO250
230 R=1:S=S+1:GOTO250
240 R=R+1
250 IFW(R,S)=0THEN210
260 IFR-1=0THEN530
265 IFW(R-1,S)<>0THEN530
270 IFS=1THEN390
280 IFW(R,S-1)<>0THEN390
290 IFR=HTHEN330
300 IFW(R+1,S)<>0THEN330
310 X=INT(RND(1)*3+1)
320 ONXGOTO790,820,860
330 IFS<>VTHEN340
334 IFZ=1THEN370
338 Q=1:GOTO350
340 IFW(R,S+1)<>0THEN370
350 X=INT(RND(1)*3+1)
360 ONXGOTO790,820,910
370 X=INT(RND(1)*2+1)
380 ONXGOTO790,820
390 IFR=HTHEN470
400 IFW(R+1,S)<>0THEN470
405 IFS<>VTHEN420
410 IFZ=1THEN450
415 Q=1:GOTO430
420 IFW(R,S+1)<>0THEN450
430 X=INT(RND(1)*3+1)
440 ONXGOTO790,860,910
450 X=INT(RND(1)*2+1)
460 ONXGOTO790,860
470 IFS<>VTHEN490
480 IFZ=1THEN520
485 Q=1:GOTO500
490 IFW(R,S+1)<>0THEN520
500 X=INT(RND(1)*2+1)
510 ONXGOTO790,910
520 GOTO790
530 IFS=1THEN670
540 IFW(R,S-1)<>0THEN670
545 IFR=HTHEN610
547 IFW(R+1,S)<>0THEN610
550 IFS<>VTHEN560
552 IFZ=1THEN590
554 Q=1:GOTO570
560 IFW(R,S+1)<>0THEN590
570 X=INT(RND(1)*3+1)
580 ONXGOTO820,860,910
590 X=INT(RND(1)*2+1)
600 ONXGOTO820,860
610 IFS<>VTHEN630
620 IFZ=1THEN660
625 Q=1:GOTO640
630 IFW(R,S+1)<>0THEN660
640 X=INT(RND(1)*2+1)
650 ONXGOTO820,910
660 GOTO820
670 IFR=HTHEN740
680 IFW(R+1,S)<>0THEN740
685 IFS<>VTHEN700
690 IFZ=1THEN730
695 Q=1:GOTO830
700 IFW(R,S+1)<>0THEN730
710 X=INT(RND(1)*2+1)
720 ONXGOTO860,910
730 GOTO860
740 IFS<>VTHEN760
750 IFZ=1THEN780
755 Q=1:GOTO770
760 IFW(R,S+1)<>0THEN780
770 GOTO910
780 GOTO1000
790 W(R-1,S)=C
800 C=C+1:V(R-1,S)=2:R=R-1
810 IFC=H*V+1THEN1010
815 Q=0:GOTO260
820 W(R,S-1)=C
830 C=C+1
840 V(R,S-1)=1:S=S-1:IFC=H*V+1THEN1010
850 Q=0:GOTO260
860 W(R+1,S)=C
870 C=C+1:IFV(R,S)=0 THEN880
875 V(R,S)=3:GOTO890
880 V(R,S)=2
890 R=R+1
900 IFC=H*V+1THEN1010
905 GOTO530
910 IFQ=1THEN960
920 W(R,S+1)=C:C=C+1:IFV(R,S)=0THEN940
930 V(R,S)=3:GOTO950
940 V(R,S)=1
950 S=S+1:IFC=H*V+1THEN1010
955 GOTO260
960 Z=1
970 IFV(R,S)=0THEN980
975 V(R,S)=3:Q=0:GOTO1000
980 V(R,S)=1:Q=0:R=1:S=1:GOTO250
1000 GOTO210
1010 REM
1030 FORJ=1TOV:PRINTCHR$(BO);CHR$(WA);
1040 FORI=1TOH:PRINTCHR$(CO);
1050 IFV(I,J)<2THENPRINTCHR$(WA);:GOTO1060
1055 PRINTCHR$(CO);
1060 NEXT:PRINTCHR$(BO):PRINTCHR$(BO);
1070 FORI=1TOH:PRINTCHR$(WA);
1075 IFV(I,J)=0ORV(I,J)=2THENPRINTCHR$(WA);:GOTO1085
1080 PRINTCHR$(CO);
1085 NEXT:PRINTCHR$(WA);CHR$(BO)
1090 NEXT:FORI=-2TOH*2:PRINTCHR$(BO);:NEXT
1099 GOTO2500
1200 Q=SM+1:PRINT:X=USR(X)
1205 Q=Q+DW:IFPEEK(Q)<>BOTHEN1205
1210 Q=Q-DW:IFPEEK(Q)=BOTHENRETURN
1220 R=Q
1222 IFR=P1THENPRINTCHR$(226);:GOTO1270
1225 IFR=PTTHENPRINTCHR$(14+D*2);:GOTO1270
1230 J=PEEK(R):IFJ=WATHENPRINTCHR$(GW(V));:GOTO1270
1235 IFJ=TRTHENPRINTCHR$(GB(V));:GOTO1270
1240 PRINTCHR$(GC(V));
1270 R=R+1:IFPEEK(R)<>BOTHEN1222
1280 PRINT:GOTO1210
1300 RETURN
1310 SR=600:VM=20:HM=20:IFPEEK(57088)<127THENHM=40
1320 RETURN
2500 CLEAR:GOSUB25000
2510 FORQ=0TODH:FORT=0TODW:J=PEEK(X+T-Q*I)
2520 POKESM+T+Q*DW,J:NEXT:NEXT
2530 PT=SM+DW+1
2540 J=PEEK(PT):IFJ<>BOTHEN2550
2545 PRINT:PRINT"MAZE BAD, TRYING AGAIN":FORQ=1TO2000:NEXT:RUN
2550 IFJ<>COTHENPT=PT+1:GOTO2540
2560 P1=PT
2565 GOSUB1310:J=9-PEEK(SR-1):IFJ=0THEN2630
2570 GOSUB1200
2575 J=9-PEEK(SR-1)
2576 JJ=PEEK(SR-2)*PEEK(SR-3)
2580 FORQ=1TOJ*50*JJ
2581 NEXT
2630 D=1
2633 H=1:R=32
2635 X=USR(X)
2700 B=-1:IFD=1ORD=2THENB=1
3000 REM
3100 L=0
3105 L=L+1:IFL>MXTHEN3110
3107 IFPEEK(PT+F(D)*L)<WATHEN3105
3110 GOSUB20890:IFL>MXTHENL=MX
3115 FORL=LTOMBSTEP-1
3117 IFPEEK(PT+L(D)+F(D)*L)=WATHENGOSUB20000:GOTO3130
3120 GOSUB20100
3130 GOSUB20200
3135 IFPEEK(PT+R(D)+L*F(D))=WATHENGOSUB20500:GOTO3150
3140 GOSUB20600
3150 GOSUB20700:NEXT
3190 GOTO8900
8900 IFOUT=1THEN30000
8950 POKEAP,14+D*2
9000 A=PEEK(11):B=PEEK(12):POKE11,0:POKE12,253:X=USR(X):J=PEEK(531)
9005 POKE11,A:POKE12,B
9010 IFJ=32THEN9100
9020 IFJ=66THEN9700
9030 IFJ=44THEN9300
9040 IFJ=46THEN9500
9050 IFJ=82THENV=1:GOSUB1200:GOTO9000
9099 GOTO9000
9100 PL=PT:PT=PT+F(D):IFPEEK(PT)=BOTHEN30000
9110 IFPEEK(PT)>COTHENPT=PL:GOTO9000
9120 POKEP1,WA:POKEPT,TR
9130 GOTO2635
9300 D=D-1:IFD<1THEND=4
9310 GOTO2635
9500 D=D+1:IFD>4THEND=1
9510 GOTO2635
9700 IFD=1ORD=2THEND=D+2:GOTO2635
9710 D=D-2:GOTO2635
20000 FORQ=0TO1-XT*(L=0)
20010 POKELU(L)-I1*Q,G1:POKELL(L)+I2*Q,G2
20020 NEXT:RETURN
20100 FORQ=0TO1-XT*(L=0)
20110 POKELU(L)-Q,G3:POKELL(L)-Q,G4
20120 NEXT:RETURN
20200 FORQ=LU(L)+ITOLL(L)-ISTEPI
20210 POKEQ,G5:NEXT:RETURN
20500 FORQ=0TO1-XT*(L=0)
20510 POKERU(L)-I2*Q,G2:POKERL(L)+I1*Q,G1
20520 NEXT:RETURN
20600 FORQ=0TO1-XT*(L=0)
20610 POKERU(L)+Q,G3:POKERL(L)+Q,G4
20620 NEXT:RETURN
20700 FORQ=RU(L)+ITORL(L)-ISTEPI
20710 POKEQ,G6:NEXT:RETURN
20890 IFPEEK(PT+F(D)*L)<>BOTHEN20895
20892 POKELU(3)+I1,14:POKELU(3)+I1+1,13:IFL<=4THENL=L-1:RETURN
20895 IFL>4THENPOKELU(3)+I1,G7:L=3:RETURN
20899 L=L-1
20900 FORQ=LU(L)+1TORU(L)-1:POKEQ,G3:NEXT
20910 FORQ=LL(L)+1TORL(L)-1:POKEQ,G4:NEXT:RETURN
25000 G1=189:G2=190:G3=128:G4=135:G5=143:G6=136:G7=188
25001 G1=190:G2=189
25002 MX=4:MB=0:XT=4
25003 BO=161:WA=96:CO=32:DW=24:DH=24
25004 TR=31
25005 DIMLU(5),LL(5),RU(5),RL(5)
25009 SM=7000
25010 I=32:DW=24:X=54117:AP=53392:LU=53415
25012 IFPEEK(57088)>126THEN25020
25013 I=64:DW=48
25015 *****PUT IN C2    AND C4 VALUES HERE
25020 I1=I+1:I2=I-1
25030 LU=53415
25035 WL=18
25040 LL=LU+I*WL:RU=LU+WL:RL=LL+WL
25050 FORQ=1TO6:LU(Q-1)=LU+Q*2*I1:RU(Q-1)=RU+Q*2*I2
25060 LL(Q-1)=LL-Q*2*I2:RL(Q-1)=RL-Q*2*I1:NEXT
25065 READM:IFM<>96THEN25065
25067 DIML(4),R(4),F(4)
25070 FORQ=1TO4:READL(Q):READR(Q):READF(Q):NEXT
25100 DATA-1,1,24,24,-24,1,1,-1,-24,-24,24,-1
25105 DIMGW(2),GC(2),GB(2)
25110 DATA161,32,32,32,32,161,161,32,46
25115 FORQ=0TO2:READGW(Q):READGC(Q):READGB(Q):NEXT
25120 GP=240
25500 RETURN
30000 PRINT"YOU MADE IT";:FORQ=1TO3000:NEXT:PRINT
30005 X=USR(X):V=2:GOSUB1200:POKE11,0:POKE12,253:X=USR(X)
30010 RUN
POKE515,0:RUN
